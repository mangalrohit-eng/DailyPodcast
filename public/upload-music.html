<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Upload Podcast Music</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
      background: #ffffff;
      color: #121212;
      padding: 40px 20px;
    }

    .container {
      max-width: 800px;
      margin: 0 auto;
    }

    header {
      background: #121212;
      color: #ffffff;
      padding: 40px;
      border-radius: 8px;
      margin-bottom: 40px;
    }

    h1 {
      font-size: 48px;
      font-weight: 700;
      margin-bottom: 10px;
    }

    .subtitle {
      font-size: 16px;
      color: #a7a7a7;
    }

    .card {
      background: #ffffff;
      border: 1px solid #d9d9d9;
      border-radius: 8px;
      padding: 32px;
      margin-bottom: 24px;
      box-shadow: 0 2px 8px rgba(0,0,0,0.05);
    }

    .card h2 {
      font-size: 24px;
      font-weight: 700;
      margin-bottom: 16px;
      color: #121212;
    }

    .card p {
      color: #6a6a6a;
      margin-bottom: 24px;
      line-height: 1.6;
    }

    .file-input-wrapper {
      position: relative;
      margin-bottom: 16px;
    }

    .file-input-wrapper input[type="file"] {
      position: absolute;
      opacity: 0;
      cursor: pointer;
      width: 100%;
      height: 100%;
    }

    .file-input-label {
      display: block;
      padding: 16px 24px;
      background: #f6f6f6;
      border: 2px dashed #d9d9d9;
      border-radius: 8px;
      text-align: center;
      cursor: pointer;
      transition: all 0.2s ease;
    }

    .file-input-label:hover {
      background: #efefef;
      border-color: #1DB954;
    }

    .file-name {
      margin-top: 8px;
      color: #6a6a6a;
      font-size: 14px;
    }

    .btn {
      padding: 14px 32px;
      border: none;
      border-radius: 500px;
      cursor: pointer;
      font-size: 16px;
      font-weight: 700;
      transition: all 0.2s ease;
      display: inline-flex;
      align-items: center;
      gap: 8px;
      letter-spacing: -0.01em;
    }

    .btn-primary {
      background: #1DB954;
      color: #000000;
    }

    .btn-primary:hover:not(:disabled) {
      background: #1ed760;
      transform: scale(1.04);
    }

    .btn:disabled {
      opacity: 0.5;
      cursor: not-allowed;
    }

    .status {
      margin-top: 16px;
      padding: 12px 16px;
      border-radius: 8px;
      font-size: 14px;
    }

    .status.success {
      background: #e6f4ea;
      color: #137333;
      border: 1px solid #1DB954;
    }

    .status.error {
      background: #fce8e6;
      color: #c5221f;
      border: 1px solid #e22134;
    }

    .status.loading {
      background: #e8f0fe;
      color: #1967d2;
      border: 1px solid #4285f4;
    }

    .info-box {
      background: #f6f6f6;
      padding: 20px;
      border-radius: 8px;
      margin-top: 32px;
    }

    .info-box h3 {
      font-size: 18px;
      font-weight: 700;
      margin-bottom: 12px;
    }

    .info-box ul {
      list-style: none;
      padding-left: 0;
    }

    .info-box li {
      padding: 8px 0;
      padding-left: 24px;
      position: relative;
    }

    .info-box li:before {
      content: "‚úì";
      position: absolute;
      left: 0;
      color: #1DB954;
      font-weight: 700;
    }
  </style>
</head>
<body>
  <div class="container">
    <header>
      <h1>üéµ Upload Podcast Music</h1>
      <p class="subtitle">Add custom intro and outro music to your podcast episodes</p>
    </header>

    <div class="card">
      <h2>Intro Music</h2>
      <p>This music will play at the beginning of each podcast episode.</p>
      
      <div class="file-input-wrapper">
        <input type="file" id="introFile" accept="audio/mpeg,audio/mp3" />
        <label for="introFile" class="file-input-label">
          üìÅ Choose intro music file (MP3)
        </label>
      </div>
      <div class="file-name" id="introFileName">No file selected</div>
      
      <button class="btn btn-primary" id="uploadIntro" disabled>
        Upload Intro Music
      </button>
      
      <div id="introStatus"></div>
    </div>

    <div class="card">
      <h2>Outro Music</h2>
      <p>This music will play at the end of each podcast episode.</p>
      
      <div class="file-input-wrapper">
        <input type="file" id="outroFile" accept="audio/mpeg,audio/mp3" />
        <label for="outroFile" class="file-input-label">
          üìÅ Choose outro music file (MP3)
        </label>
      </div>
      <div class="file-name" id="outroFileName">No file selected</div>
      
      <button class="btn btn-primary" id="uploadOutro" disabled>
        Upload Outro Music
      </button>
      
      <div id="outroStatus"></div>
    </div>

    <div class="info-box">
      <h3>üìã Requirements & Tips</h3>
      <ul>
        <li>Files must be in MP3 format</li>
        <li>Recommended length: 3-10 seconds for intro/outro</li>
        <li>Keep file size under 5MB for best performance</li>
        <li>Music should be mixed/mastered at consistent volume levels</li>
        <li>Consider fade-in/fade-out effects at the edges</li>
        <li>Ensure you have rights to use the music</li>
      </ul>
    </div>
  </div>

  <script>
    // Intro file handling
    const introFileInput = document.getElementById('introFile');
    const introFileNameDisplay = document.getElementById('introFileName');
    const uploadIntroBtn = document.getElementById('uploadIntro');
    const introStatusDiv = document.getElementById('introStatus');

    introFileInput.addEventListener('change', (e) => {
      const file = e.target.files[0];
      if (file) {
        introFileNameDisplay.textContent = `${file.name} (${formatFileSize(file.size)})`;
        uploadIntroBtn.disabled = false;
      } else {
        introFileNameDisplay.textContent = 'No file selected';
        uploadIntroBtn.disabled = true;
      }
    });

    uploadIntroBtn.addEventListener('click', () => uploadMusic('intro', introFileInput.files[0], introStatusDiv, uploadIntroBtn));

    // Outro file handling
    const outroFileInput = document.getElementById('outroFile');
    const outroFileNameDisplay = document.getElementById('outroFileName');
    const uploadOutroBtn = document.getElementById('uploadOutro');
    const outroStatusDiv = document.getElementById('outroStatus');

    outroFileInput.addEventListener('change', (e) => {
      const file = e.target.files[0];
      if (file) {
        outroFileNameDisplay.textContent = `${file.name} (${formatFileSize(file.size)})`;
        uploadOutroBtn.disabled = false;
      } else {
        outroFileNameDisplay.textContent = 'No file selected';
        uploadOutroBtn.disabled = true;
      }
    });

    uploadOutroBtn.addEventListener('click', () => uploadMusic('outro', outroFileInput.files[0], outroStatusDiv, uploadOutroBtn));

    // Upload function
    async function uploadMusic(type, file, statusDiv, button) {
      if (!file) {
        showStatus(statusDiv, 'error', 'No file selected');
        return;
      }

      button.disabled = true;
      showStatus(statusDiv, 'loading', `Uploading ${type} music...`);

      try {
        const formData = new FormData();
        formData.append('file', file);

        const response = await fetch(`/api/upload-music?type=${type}`, {
          method: 'POST',
          body: formData,
        });

        const result = await response.json();

        if (response.ok) {
          showStatus(statusDiv, 'success', `‚úÖ ${result.message} (${formatFileSize(result.size)})`);
        } else {
          throw new Error(result.error || 'Upload failed');
        }
      } catch (error) {
        showStatus(statusDiv, 'error', `‚ùå Upload failed: ${error.message}`);
        button.disabled = false;
      }
    }

    function showStatus(element, type, message) {
      element.className = `status ${type}`;
      element.textContent = message;
      element.style.display = 'block';
    }

    function formatFileSize(bytes) {
      if (bytes < 1024) return bytes + ' B';
      if (bytes < 1024 * 1024) return (bytes / 1024).toFixed(1) + ' KB';
      return (bytes / (1024 * 1024)).toFixed(1) + ' MB';
    }
  </script>
</body>
</html>

